import{R as v,v as B,c as A,r as n,j as e,P as O}from"./vendor.855a4921.js";import{u as $,a as C,F as G,v as M,Q as L,R as Q,E as U}from"./ExtraForm.5af8d2e4.js";import{F as Y}from"./Form.636858ef.js";import{B as d}from"./Button.10f28fc7.js";import{a as q,u as z,b as g,A as j}from"./index.b36afc31.js";import{u as H}from"./useNavbar.5aa93e57.js";import"./warning.b33cdbd2.js";import"./Col.fc6e8593.js";var a="C:\\Users\\runec\\Documents\\Projects\\f1predictions-ui\\src\\pages\\ResultsForm.jsx";const ie=()=>{const[b,m]=v.useState(!1),[l,f]=v.useState(0),{id:N}=B(),{push:u,goBack:D}=A(),{dispatch:E}=q(),{data:i,loading:p}=z(`${g}/${N}`);n.exports.useEffect(()=>{i&&new Date(i.qualifying_start_timestamp)>new Date&&(E({type:"NOTIFY",payload:{id:new Date().getTime(),text:"Grand Prix hasn't passed",delay:5e3,type:"danger"}}),u("/admin"))},[i]);const V=n.exports.useMemo(()=>({title:`${i?.name} - Results`||"Loading...",leftAction:D,leftActionIcon:"fa-arrow-left",showBottomNav:!1}),[i]);H(V);const{fetch:y,loading:x}=$(),{fetch:T,loading:h}=C();async function w(t){return i?.result?await T(j+`/${i.result.id}`,{result_entries:Object.entries(t).map(([s,r])=>({name:s,driver_id:r||null}))}).then(()=>{u("/admin")}):await y(g+`/${N}`+j,{result_entries:Object.entries(t).map(([s,r])=>({name:s,driver_id:r||null}))}).then(()=>{u("/admin")})}async function F(t){const s=await t();Object.keys(s).length<=0?(f(l+1),m(!1)):m(!0)}function P(){f(l-1)}const o=n.exports.useMemo(()=>p||x||h,[p,x,h]),R=n.exports.useMemo(()=>i?.result?i.result.result_entries.reduce((t,s)=>({...t,[s.name]:s.driver?.id}),{}):{FIRST_DNF:null},[i]);return e.exports.jsxDEV("div",{className:"form-container",children:e.exports.jsxDEV(G,{validationSchema:M[l],validateOnChange:b,validateOnBlur:b,initialValues:R,onSubmit:w,enableReinitialize:!0,children:({handleSubmit:t,handleChange:s,values:r,errors:c,validateForm:S,dirty:_,submitCount:I})=>e.exports.jsxDEV(e.exports.Fragment,{children:[e.exports.jsxDEV(O,{when:_&&I<1,message:"You have unsaved changes, are you sure you want to leave?"},void 0,!1,{fileName:a,lineNumber:112,columnNumber:25},globalThis),e.exports.jsxDEV(Y,{noValidate:!0,onSubmit:k=>{k.preventDefault(),t(),m(!0)},children:[l===0&&e.exports.jsxDEV(L,{handleChange:s,errors:c,values:r,disabled:o},void 0,!1,{fileName:a,lineNumber:122,columnNumber:33},globalThis),l===1&&e.exports.jsxDEV(Q,{handleChange:s,errors:c,values:r,disabled:o},void 0,!1,{fileName:a,lineNumber:124,columnNumber:49},globalThis),l===2&&e.exports.jsxDEV(U,{handleChange:s,errors:c,values:r,disabled:o},void 0,!1,{fileName:a,lineNumber:126,columnNumber:33},globalThis),e.exports.jsxDEV("div",{className:"d-flex py-3 w-10 position-sticky bg-white gap-4",style:{bottom:0},children:[l!==0&&e.exports.jsxDEV(d,{onClick:P,variant:"outline-primary",type:"button",className:"col-3",disabled:o,children:[e.exports.jsxDEV("i",{className:"fas fa-arrow-left"},void 0,!1,{fileName:a,lineNumber:137,columnNumber:41},globalThis),e.exports.jsxDEV("span",{className:"ms-3",children:"Back"},void 0,!1,{fileName:a,lineNumber:138,columnNumber:41},globalThis)]},void 0,!0,{fileName:a,lineNumber:130,columnNumber:37},globalThis),l<2&&e.exports.jsxDEV(d,{onClick:()=>F(S),variant:"primary",type:"button",className:"col text-nowrap",disabled:o,children:[e.exports.jsxDEV("span",{className:"me-3",children:"Next"},void 0,!1,{fileName:a,lineNumber:149,columnNumber:41},globalThis),e.exports.jsxDEV("i",{className:"fas fa-arrow-right"},void 0,!1,{fileName:a,lineNumber:150,columnNumber:41},globalThis)]},void 0,!0,{fileName:a,lineNumber:142,columnNumber:37},globalThis),l===2&&e.exports.jsxDEV(d,{variant:"primary",type:"submit",className:"col",disabled:o,children:[e.exports.jsxDEV("span",{className:"me-3",children:"Save"},void 0,!1,{fileName:a,lineNumber:155,columnNumber:41},globalThis),e.exports.jsxDEV("i",{className:"fas fa-save"},void 0,!1,{fileName:a,lineNumber:156,columnNumber:41},globalThis)]},void 0,!0,{fileName:a,lineNumber:154,columnNumber:37},globalThis)]},void 0,!0,{fileName:a,lineNumber:128,columnNumber:29},globalThis)]},void 0,!0,{fileName:a,lineNumber:113,columnNumber:25},globalThis)]},void 0,!0)},void 0,!1,{fileName:a,lineNumber:102,columnNumber:13},globalThis)},void 0,!1,{fileName:a,lineNumber:101,columnNumber:9},globalThis)};export{ie as default};
