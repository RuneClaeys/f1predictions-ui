import{R as g,o as B,u as O,r as n,j as e,P as A}from"./vendor.ec64f40b.js";import{u as C,a as G,F as $,v as M,Q,R as Y,E as q}from"./ExtraForm.4289962f.js";import{F as z}from"./Form.d8d6be7d.js";import{B as c}from"./Button.7e46c1cd.js";import{a as H,u as X,b as j,c as D}from"./index.94d5cdbf.js";import{u as J}from"./useNavbar.2b4c29f6.js";import"./warning.b33cdbd2.js";import"./Col.e1c649d0.js";var a="C:\\Projects\\f1predictions-ui\\src\\pages\\PredictionForm.jsx";const ie=()=>{const[b,m]=g.useState(!1),[i,f]=g.useState(0),{id:N}=B(),{push:u,goBack:p}=O(),{dispatch:E}=H(),{data:t,loading:x}=X(`${j}/${N}`);n.exports.useEffect(()=>{t&&new Date(t.qualifying_start_timestamp)<new Date&&(E({type:"NOTIFY",payload:{id:new Date().getTime(),text:"Grand Prix has already passed",delay:5e3,type:"danger"}}),u("/"))},[t]);const y=n.exports.useMemo(()=>({leftAction:p,leftActionIcon:"fa-arrow-left",showBottomNav:!1}),[p]);J(y);const{fetch:V,loading:h}=C(),{fetch:T,loading:v}=G();async function P(o){return t?.user_prediction?await T(D+`/${t.user_prediction.id}`,{result_entries:Object.entries(o).map(([s,r])=>({name:s,driver_id:r}))}).then(()=>u("/")):await V(j+`/${N}`+D,{prediction_entries:Object.entries(o).map(([s,r])=>({name:s,driver_id:r}))}).then(()=>u("/"))}async function w(o){const s=await o();Object.keys(s).length<=0?(f(i+1),m(!1)):m(!0)}function _(){f(i-1)}const l=n.exports.useMemo(()=>x||h||v,[x,h,v]),F=n.exports.useMemo(()=>t?.user_prediction?t.user_prediction.prediction_entries.reduce((o,s)=>({...o,[s.name]:s.driver.id}),{}):{},[t]);return e.exports.jsxDEV("div",{className:"form-container",children:e.exports.jsxDEV($,{validationSchema:M[i],validateOnChange:b,validateOnBlur:b,initialValues:F,onSubmit:P,enableReinitialize:!0,children:({handleSubmit:o,handleChange:s,values:r,errors:d,validateForm:S,dirty:I,submitCount:R})=>e.exports.jsxDEV(e.exports.Fragment,{children:[e.exports.jsxDEV(A,{when:I&&R<1,message:"You have unsaved changes, are you sure you want to leave?"},void 0,!1,{fileName:a,lineNumber:103,columnNumber:19},globalThis),e.exports.jsxDEV(z,{noValidate:!0,onSubmit:k=>{k.preventDefault(),o(),m(!0)},children:[i===0&&e.exports.jsxDEV(Q,{handleChange:s,errors:d,values:r,disabled:l},void 0,!1,{fileName:a,lineNumber:112,columnNumber:42},globalThis),i===1&&e.exports.jsxDEV(Y,{handleChange:s,errors:d,values:r,disabled:l},void 0,!1,{fileName:a,lineNumber:113,columnNumber:42},globalThis),i===2&&e.exports.jsxDEV(q,{handleChange:s,errors:d,values:r,disabled:l},void 0,!1,{fileName:a,lineNumber:114,columnNumber:42},globalThis),e.exports.jsxDEV("div",{className:"d-flex py-3 w-10 position-sticky bg-white gap-4",style:{bottom:0},children:[i!==0&&e.exports.jsxDEV(c,{onClick:_,variant:"outline-primary",type:"button",className:"col-3",disabled:l,children:[e.exports.jsxDEV("i",{className:"fas fa-arrow-left"},void 0,!1,{fileName:a,lineNumber:119,columnNumber:31},globalThis),e.exports.jsxDEV("span",{className:"ms-3",children:"Back"},void 0,!1,{fileName:a,lineNumber:120,columnNumber:31},globalThis)]},void 0,!0,{fileName:a,lineNumber:118,columnNumber:28},globalThis),i<2&&e.exports.jsxDEV(c,{onClick:()=>w(S),variant:"primary",type:"button",className:"col text-nowrap",disabled:l,children:[e.exports.jsxDEV("span",{className:"me-3",children:"Next"},void 0,!1,{fileName:a,lineNumber:131,columnNumber:31},globalThis),e.exports.jsxDEV("i",{className:"fas fa-arrow-right"},void 0,!1,{fileName:a,lineNumber:132,columnNumber:31},globalThis)]},void 0,!0,{fileName:a,lineNumber:124,columnNumber:28},globalThis),i===2&&e.exports.jsxDEV(c,{variant:"primary",type:"submit",className:"col",disabled:l,children:[e.exports.jsxDEV("span",{className:"me-3",children:"Save"},void 0,!1,{fileName:a,lineNumber:137,columnNumber:31},globalThis),e.exports.jsxDEV("i",{className:"fas fa-save"},void 0,!1,{fileName:a,lineNumber:138,columnNumber:31},globalThis)]},void 0,!0,{fileName:a,lineNumber:136,columnNumber:28},globalThis)]},void 0,!0,{fileName:a,lineNumber:116,columnNumber:22},globalThis)]},void 0,!0,{fileName:a,lineNumber:104,columnNumber:19},globalThis)]},void 0,!0)},void 0,!1,{fileName:a,lineNumber:93,columnNumber:10},globalThis)},void 0,!1,{fileName:a,lineNumber:92,columnNumber:7},globalThis)};export{ie as default};
