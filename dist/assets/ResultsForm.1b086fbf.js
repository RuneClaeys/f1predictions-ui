import{R as v,v as I,u as A,r as n,j as e,P as O}from"./vendor.761b0733.js";import{u as $,a as C,F as G,v as M,Q as L,R as Q,E as Y}from"./ExtraForm.abac9246.js";import{F as q}from"./Form.f9dd27f5.js";import{B as c}from"./Button.b639cc19.js";import{a as z,u as H,b as g,A as j}from"./index.fb8ab378.js";import{u as U}from"./useNavbar.e0798357.js";import"./warning.b33cdbd2.js";import"./Col.48c55a83.js";var a="C:\\Projects\\f1predictions-ui\\src\\pages\\ResultsForm.jsx";const ie=()=>{const[b,m]=v.useState(!1),[t,f]=v.useState(0),{id:N}=I(),{push:u,goBack:D}=A(),{dispatch:E}=z(),{data:i,loading:p}=H(`${g}/${N}`);n.exports.useEffect(()=>{i&&new Date(i.qualifying_start_timestamp)>new Date&&(E({type:"NOTIFY",payload:{id:new Date().getTime(),text:"Grand Prix hasn't passed",delay:5e3,type:"danger"}}),u("/admin"))},[i]);const V=n.exports.useMemo(()=>({title:`${i?.name} - Results`||"Loading...",leftAction:D,leftActionIcon:"fa-arrow-left",showBottomNav:!1}),[i]);U(V);const{fetch:y,loading:x}=$(),{fetch:T,loading:h}=C();async function w(l){return i?.result?await T(j+`/${i.result.id}`,{result_entries:Object.entries(l).map(([s,o])=>({name:s,driver_id:o}))}).then(()=>{u("/admin")}):await y(g+`/${N}`+j,{result_entries:Object.entries(l).map(([s,o])=>({name:s,driver_id:o}))}).then(()=>{u("/admin")})}async function F(l){const s=await l();Object.keys(s).length<=0?(f(t+1),m(!1)):m(!0)}function P(){f(t-1)}const r=n.exports.useMemo(()=>p||x||h,[p,x,h]),R=n.exports.useMemo(()=>i?.result?i.result.result_entries.reduce((l,s)=>({...l,[s.name]:s.driver.id}),{}):{},[i]);return e.exports.jsxDEV("div",{className:"form-container",children:e.exports.jsxDEV(G,{validationSchema:M[t],validateOnChange:b,validateOnBlur:b,initialValues:R,onSubmit:w,enableReinitialize:!0,children:({handleSubmit:l,handleChange:s,values:o,errors:d,validateForm:S,dirty:_,submitCount:k})=>e.exports.jsxDEV(e.exports.Fragment,{children:[e.exports.jsxDEV(O,{when:_&&k<1,message:"You have unsaved changes, are you sure you want to leave?"},void 0,!1,{fileName:a,lineNumber:109,columnNumber:19},globalThis),e.exports.jsxDEV(q,{noValidate:!0,onSubmit:B=>{B.preventDefault(),l(),m(!0)},children:[t===0&&e.exports.jsxDEV(L,{handleChange:s,errors:d,values:o,disabled:r},void 0,!1,{fileName:a,lineNumber:118,columnNumber:42},globalThis),t===1&&e.exports.jsxDEV(Q,{handleChange:s,errors:d,values:o,disabled:r},void 0,!1,{fileName:a,lineNumber:119,columnNumber:42},globalThis),t===2&&e.exports.jsxDEV(Y,{handleChange:s,errors:d,values:o,disabled:r},void 0,!1,{fileName:a,lineNumber:120,columnNumber:42},globalThis),e.exports.jsxDEV("div",{className:"d-flex py-3 w-10 position-sticky bg-white gap-4",style:{bottom:0},children:[t!==0&&e.exports.jsxDEV(c,{onClick:P,variant:"outline-primary",type:"button",className:"col-3",disabled:r,children:[e.exports.jsxDEV("i",{className:"fas fa-arrow-left"},void 0,!1,{fileName:a,lineNumber:124,columnNumber:31},globalThis),e.exports.jsxDEV("span",{className:"ms-3",children:"Back"},void 0,!1,{fileName:a,lineNumber:125,columnNumber:31},globalThis)]},void 0,!0,{fileName:a,lineNumber:123,columnNumber:28},globalThis),t<2&&e.exports.jsxDEV(c,{onClick:()=>F(S),variant:"primary",type:"button",className:"col text-nowrap",disabled:r,children:[e.exports.jsxDEV("span",{className:"me-3",children:"Next"},void 0,!1,{fileName:a,lineNumber:136,columnNumber:31},globalThis),e.exports.jsxDEV("i",{className:"fas fa-arrow-right"},void 0,!1,{fileName:a,lineNumber:137,columnNumber:31},globalThis)]},void 0,!0,{fileName:a,lineNumber:129,columnNumber:28},globalThis),t===2&&e.exports.jsxDEV(c,{variant:"primary",type:"submit",className:"col",disabled:r,children:[e.exports.jsxDEV("span",{className:"me-3",children:"Save"},void 0,!1,{fileName:a,lineNumber:142,columnNumber:31},globalThis),e.exports.jsxDEV("i",{className:"fas fa-save"},void 0,!1,{fileName:a,lineNumber:143,columnNumber:31},globalThis)]},void 0,!0,{fileName:a,lineNumber:141,columnNumber:28},globalThis)]},void 0,!0,{fileName:a,lineNumber:121,columnNumber:22},globalThis)]},void 0,!0,{fileName:a,lineNumber:110,columnNumber:19},globalThis)]},void 0,!0)},void 0,!1,{fileName:a,lineNumber:99,columnNumber:10},globalThis)},void 0,!1,{fileName:a,lineNumber:98,columnNumber:7},globalThis)};export{ie as default};
